model Listing {
  id               String            @id @default(cuid())

  ownerId          String
  owner            User              @relation(fields: [ownerId], references: [id], onDelete: Cascade)

  category         ListingCategory   @default(ANY)

  locationId       String            @unique
  location         Location          @relation(fields: [locationId], references: [id], onDelete: Cascade)

  collegeId        String?
  collegeDetails  College?          @relation(fields: [collegeId], references: [id])

  title            String
  description      String
  
  furnishedStatus  FurnishedStatus   @default(UNFURNISHED)
  sharingType      SharingType       @default(ANY)
  genderPreference GenderPreference  @default(ANY)

  price            Int
  deposit          Int?

  isAvailable      Boolean           @default(true)

  images           String[]

  // Amenities
  tag_ac             Boolean @default(false)
  tag_cooler         Boolean @default(false)
  tag_noBrokerage    Boolean @default(false)
  tag_wifi           Boolean @default(false)
  tag_cook           Boolean @default(false)
  tag_maid           Boolean @default(false)
  tag_geyser         Boolean @default(false)
  tag_metroNear      Boolean @default(false)
  tag_noRestrictions Boolean @default(false)

  connectionRequests ConnectionRequest[]
  savedByUsers       SavedListing[]

  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt

  @@index([price])
  @@index([category])
}


model Location {
  id              String   @id @default(cuid())

  latitude        Float
  longitude       Float

  displayAddress  String

  house           String?
  road            String?
  area            String?
  city            String?
  state           String?
  country         String?
  pinCode         String?

  listing         Listing?

  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

enum ListingCategory {
  ANY
  PG
  FLAT
  ROOM
  HOSTEL
}

enum FurnishedStatus {
  UNFURNISHED
  SEMI_FURNISHED
  FURNISHED
}

enum SharingType {
  ANY
  SINGLE
  DOUBLE
  TRIPLE
}

enum GenderPreference {
  ANY
  MALE
  FEMALE
  OTHER
}


model SavedListing {
  id        String   @id @default(cuid())
  savedAt   DateTime @default(now())
  userId    String
  listingId String
  listing   Listing  @relation(fields: [listingId], references: [id], onDelete: Cascade)
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, listingId])
  @@index([listingId])
}

model College {
  id        String   @id @default(cuid())
  name      String
  city      String
  state     String

  latitude  Float
  longitude Float

  listings  Listing[]

  createdAt DateTime @default(now())

  @@unique([name, city])
  @@index([name])
}

